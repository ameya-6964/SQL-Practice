SELECT E.ENAME,E.JOB,E.SAL - 100 AS PENALTY ,E.COMM,E.EMPNO,D.LOC
FROM EMP E JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
WHERE E.JOB NOT IN ('PRESIDENT','CLERK')
AND TO_CHAR(E.HIREDATE,'YY') IN (SELECT TO_CHAR(HIREDATE,'YY')
                           FROM EMP
                           WHERE ENAME IN ('ALLEN','JONES'))
AND E.MGR IN (SELECT EMPNO
         FROM EMP
         WHERE ENAME IN ('KING','BLAKE'))
AND E.SAL < ( SELECT SAL
         FROM (SELECT ROWNUM AS SLNO,SAL
               FROM (SELECT DISTINCT SAL
                     FROM EMP
                      ORDER BY SAL DESC))
           WHERE SLNO = 10)
AND LENGTH(TO_CHAR(E.HIREDATE,'FMDAY')) BETWEEN 5 AND 9
AND LENGTH(E.ENAME) < 9
/
