SELECT E.ENAME,E.JOB,M.ENAME,M.JOB,MM.ENAME,SUBSTR(MD.DNAME,1,1), M.SAL * 12
FROM EMP E JOIN EMP M
ON E.MGR = M.EMPNO
JOIN EMP MM
ON M.MGR = MM.EMPNO
JOIN DEPT MMD
ON MM.DEPTNO = MMD.DEPTNO
JOIN DEPT MD
ON M.DEPTNO = MD.DEPTNO 
WHERE SUBSTR(TO_CHAR(E.HIREDATE,'FMDAY'),1,1) IN ('S','T','M')
AND E.JOB NOT IN ('CLERK','ANALYST')
AND M.SAL > (SELECT SAL
	     FROM (SELECT DENSE_RANK() OVER (ORDER BY SAL ASC) AS RANK,SAL
		   FROM EMP)
	      WHERE RANK = 3)
AND LENGTH(MMD.LOC) < 12
/
