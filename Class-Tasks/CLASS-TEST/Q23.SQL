SELECT E.ENAME,M.ENAME,MMD.DNAME,MMD.LOC
FROM EMP E JOIN EMP M
ON E.MGR = M.EMPNO
JOIN EMP MM
ON M.MGR = MM.EMPNO
JOIN DEPT MMD
ON MM.DEPTNO = MMD.DEPTNO
WHERE E.COMM IS NOT NULL
AND E.JOB IN ('SALESMAN','CLERK')
AND M.HIREDATE < (SELECT HIREDATE
		  FROM EMP
		  WHERE ENAME='ADAMS')
AND LENGTH(MM.ENAME) BETWEEN 3 AND 9
AND LENGTH(MMD.DNAME) BETWEEN 3 AND 9
/
