SELECT E.ENAME,M.ENAME,MM.ENAME,SUBSTR(ED.DNAME,1,3) AS ED,SUBSTR(MD.DNAME,1,3) AS MD,SUBSTR(MMD.DNAME,1,3) AS MMD,
LOWER(SUBSTR(ED.LOC,1,3)) AS ELOC,LOWER(SUBSTR(MD.LOC,1,3)) AS MDLOC,LOWER(SUBSTR(MMD.LOC,1,3)) AS MMLOC,TO_CHAR(E.HIREDATE,'HH24') AS TIME
FROM EMP E JOIN EMP M
ON E.MGR = M.EMPNO
JOIN EMP MM
ON M.MGR = MM.EMPNO
JOIN DEPT ED
ON E.DEPTNO = ED.DEPTNO
JOIN DEPT MD
ON M.DEPTNO = MD.DEPTNO
JOIN DEPT MMD
ON MM.DEPTNO = MMD.DEPTNO
WHERE E.SAL IN (SELECT SAL
		FROM (SELECT DENSE_RANK() OVER (ORDER BY SAL DESC) AS RANK,SAL
			FROM EMP)
		WHERE RANK IN (2,4,10))
AND INSTR(E.ENAME,'P', 1,2) = 0
/
